# AI论文写作系统 - 需求规范

## 1. 项目概述

### 1.1 项目背景
为RuoYi-FastAPI系统增加AI论文写作功能，帮助学生快速生成符合学校格式要求的学术论文，同时确保内容能够通过AIGC检测和查重检查。

### 1.2 目标用户
- 本科生、研究生、博士生
- 需要撰写学术论文的在校学生
- 需要快速生成论文初稿的用户

### 1.3 核心价值
- 自动化论文格式处理，节省排版时间
- AI辅助内容生成，提高写作效率
- 智能去AI化处理，降低AIGC检测率
- 多学校格式支持，适应不同需求

---

## 2. 功能需求

### 2.1 格式模板管理

#### 2.1.1 模板上传
**用户故事**: 作为管理员，我希望能够上传学校的论文格式要求文档，以便系统能够解析并应用这些格式规则。

**接受标准**:
- [ ] 支持上传Word文档（.docx格式）
- [ ] 自动解析文档格式规则（字体、字号、行距、页边距、标题样式等）
- [ ] 提取章节结构模板
- [ ] 支持手动调整解析结果
- [ ] 保存为可复用的格式模板

#### 2.1.2 模板管理
**用户故事**: 作为管理员，我希望能够管理所有格式模板，包括查看、编辑、删除和启用/禁用。

**接受标准**:
- [ ] 模板列表展示（学校名称、专业、学历层次、创建时间）
- [ ] 模板详情查看
- [ ] 模板编辑功能
- [ ] 模板删除功能（软删除）
- [ ] 模板启用/禁用状态切换
- [ ] 模板预览功能

#### 2.1.3 模板分类
**用户故事**: 作为用户，我希望能够按学校、专业、学历层次筛选模板，快速找到适合的格式。

**接受标准**:
- [ ] 按学校分类
- [ ] 按专业分类（理工科、文科、医学等）
- [ ] 按学历层次分类（本科、硕士、博士）
- [ ] 支持关键词搜索
- [ ] 热门模板推荐

---

### 2.2 用户权益管理

#### 2.2.1 会员体系
**用户故事**: 作为运营人员，我希望设置不同的会员等级，提供差异化服务。

**会员等级**:
| 等级 | 价格 | 字数配额 | 使用次数 | 特权功能 |
|------|------|----------|----------|----------|
| 免费版 | ¥0 | 5000字 | 1次 | 基础生成 |
| 基础版 | ¥99/月 | 50000字 | 10次 | 去AI化 |
| 专业版 | ¥299/月 | 200000字 | 50次 | 高级润色 + 查重 |
| 旗舰版 | ¥599/月 | 无限 | 无限 | 全部功能 + 人工审核 |

**接受标准**:
- [ ] 会员等级配置管理
- [ ] 字数配额实时扣减
- [ ] 使用次数统计
- [ ] 会员到期提醒
- [ ] 自动降级处理

#### 2.2.2 权限控制
**用户故事**: 作为系统，我需要根据用户的会员等级控制功能访问权限。

**接受标准**:
- [ ] 未付费用户只能查看功能介绍
- [ ] 免费版用户限制字数和次数
- [ ] 付费用户解锁对应等级功能
- [ ] 配额不足时提示升级
- [ ] 权限验证中间件

---

### 2.3 论文创作流程

#### 2.3.1 创建论文
**用户故事**: 作为用户，我希望能够快速开始论文创作，选择合适的格式和填写基本信息。

**接受标准**:
- [ ] 选择学校格式模板
- [ ] 填写论文基本信息：
  - 论文标题
  - 专业名称
  - 学历层次（本科/硕士/博士）
  - 研究方向
  - 关键词（3-5个）
  - 论文类型（理论研究/实证研究/综述等）
- [ ] 表单验证
- [ ] 保存为草稿

#### 2.3.2 大纲生成
**用户故事**: 作为用户，我希望AI能够根据我的论文标题和关键词，自动生成论文大纲。

**接受标准**:
- [ ] 基于标题和关键词生成大纲
- [ ] 支持多种大纲结构（三段式、五段式等）
- [ ] 大纲包含：
  - 摘要
  - 引言
  - 文献综述
  - 研究方法
  - 结果与分析
  - 结论
  - 参考文献
- [ ] 支持手动调整大纲
- [ ] 支持添加/删除/移动章节
- [ ] 大纲预览

#### 2.3.3 内容生成
**用户故事**: 作为用户，我希望AI能够按章节生成论文内容，并且内容质量高、逻辑清晰。

**接受标准**:
- [ ] 按章节顺序生成内容
- [ ] 支持单章节重新生成
- [ ] 生成内容包含：
  - 段落文本
  - 图表建议
  - 数据分析
  - 引用文献
- [ ] 实时显示生成进度
- [ ] 支持暂停/继续生成
- [ ] 字数统计

#### 2.3.4 内容编辑
**用户故事**: 作为用户，我希望能够在线编辑生成的内容，进行个性化调整。

**接受标准**:
- [ ] 富文本编辑器
- [ ] 支持格式调整（加粗、斜体、下划线等）
- [ ] 支持插入图片、表格
- [ ] 支持插入公式
- [ ] 实时保存
- [ ] 版本历史记录
- [ ] 撤销/重做功能

#### 2.3.5 AI优化功能
**用户故事**: 作为用户，我希望AI能够优化我的论文内容，降低AIGC检测率和查重率。

**接受标准**:
- [ ] **去AI化处理**：
  - 改写AI痕迹明显的句子
  - 增加人性化表达
  - 调整句式结构
  - 添加过渡词和连接词
- [ ] **降重处理**：
  - 同义词替换
  - 句式转换
  - 段落重组
- [ ] **内容润色**：
  - 语法检查
  - 逻辑优化
  - 表达优化
- [ ] **AIGC检测率预估**
- [ ] **查重率预估**

#### 2.3.6 格式应用
**用户故事**: 作为用户，我希望系统能够自动应用学校的格式要求，生成符合规范的Word文档。

**接受标准**:
- [ ] 自动应用格式模板
- [ ] 标题层级格式化
- [ ] 页眉页脚设置
- [ ] 页码格式
- [ ] 目录自动生成
- [ ] 图表编号
- [ ] 参考文献格式化
- [ ] 实时预览

#### 2.3.7 导出功能
**用户故事**: 作为用户，我希望能够导出符合格式要求的Word文档。

**接受标准**:
- [ ] 导出为.docx格式
- [ ] 保留所有格式
- [ ] 包含目录
- [ ] 包含页眉页脚
- [ ] 文件命名规则
- [ ] 下载记录

---

### 2.4 支付系统

#### 2.4.1 套餐购买
**用户故事**: 作为用户，我希望能够购买会员套餐，解锁更多功能。

**接受标准**:
- [ ] 套餐列表展示
- [ ] 套餐对比功能
- [ ] 选择支付方式（微信/支付宝）
- [ ] 生成支付订单
- [ ] 支付状态查询
- [ ] 支付成功后自动开通会员

#### 2.4.2 微信支付集成
**用户故事**: 作为用户，我希望能够使用微信支付购买套餐。

**接受标准**:
- [ ] 微信扫码支付
- [ ] 微信H5支付（移动端）
- [ ] 支付回调处理
- [ ] 支付状态同步
- [ ] 支付失败重试
- [ ] 退款处理

#### 2.4.3 支付宝支付集成
**用户故事**: 作为用户，我希望能够使用支付宝支付购买套餐。

**接受标准**:
- [ ] 支付宝扫码支付
- [ ] 支付宝H5支付（移动端）
- [ ] 支付回调处理
- [ ] 支付状态同步
- [ ] 支付失败重试
- [ ] 退款处理

#### 2.4.4 充值记录
**用户故事**: 作为用户，我希望能够查看我的充值记录和消费记录。

**接受标准**:
- [ ] 充值记录列表
- [ ] 消费记录列表
- [ ] 订单详情查看
- [ ] 发票申请
- [ ] 退款申请
- [ ] 记录导出

---

### 2.5 历史记录管理

#### 2.5.1 论文草稿
**用户故事**: 作为用户，我希望系统能够自动保存我的论文草稿，避免数据丢失。

**接受标准**:
- [ ] 自动保存（每30秒）
- [ ] 手动保存
- [ ] 草稿列表展示
- [ ] 草稿搜索
- [ ] 草稿重命名
- [ ] 草稿删除（软删除）
- [ ] 草稿恢复

#### 2.5.2 版本历史
**用户故事**: 作为用户，我希望能够查看论文的历史版本，并恢复到某个版本。

**接受标准**:
- [ ] 版本列表展示
- [ ] 版本对比功能
- [ ] 版本恢复
- [ ] 版本删除
- [ ] 版本导出

#### 2.5.3 导出记录
**用户故事**: 作为用户，我希望能够查看我的导出记录，并重新下载。

**接受标准**:
- [ ] 导出记录列表
- [ ] 重新下载
- [ ] 记录删除
- [ ] 导出统计

---

### 2.6 系统管理

#### 2.6.1 用户管理
**用户故事**: 作为管理员，我希望能够管理所有用户，查看用户使用情况。

**接受标准**:
- [ ] 用户列表
- [ ] 用户详情
- [ ] 会员信息查看
- [ ] 使用统计
- [ ] 账号冻结/解冻
- [ ] 手动调整配额

#### 2.6.2 订单管理
**用户故事**: 作为管理员，我希望能够管理所有订单，处理退款等问题。

**接受标准**:
- [ ] 订单列表
- [ ] 订单详情
- [ ] 订单状态管理
- [ ] 退款处理
- [ ] 订单导出
- [ ] 财务报表

#### 2.6.3 内容审核
**用户故事**: 作为管理员，我希望能够审核用户生成的论文内容，防止违规内容。

**接受标准**:
- [ ] 待审核列表
- [ ] 内容查看
- [ ] 审核通过/拒绝
- [ ] 违规标记
- [ ] 审核记录

#### 2.6.4 系统配置
**用户故事**: 作为管理员，我希望能够配置系统参数。

**接受标准**:
- [ ] AI模型配置
- [ ] 支付参数配置
- [ ] 会员套餐配置
- [ ] 字数单价配置
- [ ] 系统公告管理

---

## 3. 非功能需求

### 3.1 性能要求
- 论文生成响应时间 < 30秒/千字
- 支持并发用户数 > 1000
- 系统可用性 > 99.9%
- 数据库查询响应时间 < 100ms

### 3.2 安全要求
- 用户数据加密存储
- 支付信息安全传输（HTTPS）
- 防止SQL注入、XSS攻击
- 敏感操作日志记录
- 定期数据备份

### 3.3 兼容性要求
- 支持Chrome、Firefox、Safari、Edge浏览器
- 支持PC端和移动端
- 支持Word 2016及以上版本

### 3.4 可扩展性
- 支持接入多种AI模型
- 支持扩展支付方式
- 支持多语言（中文、英文）

---

## 4. 技术架构建议

### 4.1 后端技术栈
- **框架**: FastAPI (已有)
- **数据库**: MySQL (已有)
- **缓存**: Redis (已有)
- **AI模型**: 
  - 通义千问 (文本生成)
  - GPT-4 (高级润色)
  - 本地模型 (去AI化处理)
- **文档处理**: python-docx
- **支付SDK**: 
  - 微信支付SDK
  - 支付宝SDK

### 4.2 前端技术栈
- **框架**: Vue 3 (已有)
- **UI组件**: Element Plus (已有)
- **富文本编辑器**: TinyMCE / Quill
- **文档预览**: Docx-preview

### 4.3 模块结构
```
module_thesis/
├── controller/          # 控制器
│   ├── template_controller.py      # 模板管理
│   ├── thesis_controller.py        # 论文管理
│   ├── payment_controller.py       # 支付管理
│   └── member_controller.py        # 会员管理
├── service/            # 业务逻辑
│   ├── template_service.py
│   ├── thesis_service.py
│   ├── ai_service.py               # AI生成服务
│   ├── format_service.py           # 格式处理服务
│   ├── payment_service.py
│   └── member_service.py
├── dao/                # 数据访问
├── entity/             # 实体类
│   ├── do/            # 数据库实体
│   └── vo/            # 视图对象
└── utils/              # 工具类
    ├── docx_parser.py              # Word文档解析
    ├── aigc_detector.py            # AIGC检测
    └── plagiarism_checker.py       # 查重检测
```

---

## 5. 数据库设计要点

### 5.1 核心表
- `thesis_template` - 格式模板表
- `thesis_paper` - 论文表
- `thesis_chapter` - 章节表
- `thesis_version` - 版本历史表
- `member_package` - 会员套餐表
- `member_order` - 订单表
- `member_quota` - 配额记录表
- `payment_record` - 支付记录表

---

## 6. 开发优先级

### P0 (核心功能 - 第一期)
1. 用户权益管理（会员体系）
2. 论文创建与基本信息填写
3. AI大纲生成
4. AI内容生成（基础版）
5. 格式应用与导出
6. 支付系统集成（微信/支付宝）

### P1 (重要功能 - 第二期)
1. 格式模板上传与解析
2. 去AI化处理
3. 内容润色
4. 历史记录管理
5. 版本控制

### P2 (增强功能 - 第三期)
1. AIGC检测率预估
2. 查重率预估
3. 高级编辑功能
4. 人工审核
5. 数据统计与报表

---

## 7. 风险与挑战

### 7.1 技术风险
- Word格式解析的准确性
- AI生成内容的质量控制
- 去AI化效果的保证
- 大规模并发处理

### 7.2 业务风险
- 学术诚信问题
- 版权问题
- 用户隐私保护
- 支付安全

### 7.3 应对措施
- 添加免责声明
- 内容审核机制
- 数据加密存储
- 定期安全审计

---

## 8. 项目里程碑

| 阶段 | 时间 | 交付内容 |
|------|------|----------|
| 需求评审 | Week 1 | 需求文档确认 |
| 数据库设计 | Week 2 | 数据库表结构 |
| 核心功能开发 | Week 3-6 | P0功能完成 |
| 支付集成 | Week 7-8 | 支付功能测试 |
| 测试与优化 | Week 9-10 | 功能测试、性能优化 |
| 上线准备 | Week 11 | 部署、培训 |
| 正式上线 | Week 12 | 生产环境发布 |

---

## 9. 后续迭代计划

### 第二期功能
- 多人协作编辑
- 导师评审功能
- 论文模板市场
- AI智能问答

### 第三期功能
- 移动端APP
- 语音输入
- 图表自动生成
- 国际化支持
