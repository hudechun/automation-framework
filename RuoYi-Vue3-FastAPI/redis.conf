# Redis配置文件 - 用于开发环境Token持久化

# 绑定地址
bind 127.0.0.1

# 端口
port 6379

# 后台运行
daemonize no

# 日志级别
loglevel notice

# 日志文件
logfile ""

# 数据库数量
databases 16

# ==================== RDB持久化配置 ====================
# 900秒内至少1个key被修改，则触发保存
save 900 1
# 300秒内至少10个key被修改，则触发保存
save 300 10
# 60秒内至少10000个key被修改，则触发保存
save 60 10000

# RDB文件名
dbfilename dump.rdb

# RDB文件保存目录
dir ./

# RDB文件压缩
rdbcompression yes

# RDB文件校验
rdbchecksum yes

# ==================== AOF持久化配置 ====================
# 启用AOF持久化（推荐）
appendonly yes

# AOF文件名
appendfilename "appendonly.aof"

# AOF同步策略：
# always - 每次写操作都同步（最安全但最慢）
# everysec - 每秒同步一次（推荐，平衡性能和安全）
# no - 由操作系统决定何时同步（最快但最不安全）
appendfsync everysec

# AOF重写配置
auto-aof-rewrite-percentage 100
auto-aof-rewrite-min-size 64mb

# ==================== 内存管理 ====================
# 最大内存（开发环境设置为256MB）
maxmemory 256mb

# 内存淘汰策略：
# noeviction - 不淘汰，内存满时返回错误（推荐用于Token存储）
# allkeys-lru - 淘汰最近最少使用的key
# volatile-lru - 淘汰设置了过期时间的最近最少使用的key
# allkeys-random - 随机淘汰key
# volatile-random - 随机淘汰设置了过期时间的key
# volatile-ttl - 淘汰即将过期的key
maxmemory-policy noeviction

# ==================== 安全配置 ====================
# 密码（开发环境可以不设置）
# requirepass your_password_here

# ==================== 性能优化 ====================
# 慢查询日志
slowlog-log-slower-than 10000
slowlog-max-len 128

# 客户端连接数
maxclients 10000

# TCP连接配置
tcp-backlog 511
timeout 0
tcp-keepalive 300
