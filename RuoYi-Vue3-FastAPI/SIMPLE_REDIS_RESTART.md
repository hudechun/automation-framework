# Redis服务重启指南（最简单方法）

## 问题

后端重启后Token失效，需要重新登录。

## 最简单的解决方案

### 方法1：任务管理器重启Redis服务（推荐）✅

**步骤**：

1. **打开任务管理器**
   - 按 `Ctrl + Shift + Esc`
   - 或右键任务栏 → 任务管理器

2. **切换到"服务"标签**

3. **找到Redis服务**
   - 服务名称：`Redis`
   - 状态：正在运行

4. **右键点击Redis → 重新启动**

5. **完成！**

**效果**：
- Redis服务重启
- 但是**数据会丢失**（因为没有启用持久化）
- 所以用户还是需要重新登录

### 方法2：使用服务管理器（services.msc）

**步骤**：

1. **打开服务管理器**
   - 按 `Win + R`
   - 输入 `services.msc`
   - 按回车

2. **找到Redis服务**
   - 向下滚动找到 `Redis`

3. **右键 → 重新启动**

4. **完成！**

## 但是...这样还是会丢失Token！

### 为什么？

无论用哪种方法重启Redis，如果没有启用持久化，数据都会丢失：

```
Redis重启 → 内存数据清空 → Token丢失 → 用户需要重新登录
```

## 真正的解决方案

### 当前配置（已完成）✅

**Token有效期延长到7天**

**效果**：
- ✅ 7天内无需重新登录
- ✅ 前端自动提示重新登录
- ✅ 点击一次即可继续使用
- ❌ 后端重启后仍需重新登录

**适用场景**：
- 开发环境
- 不频繁重启后端
- 可以接受偶尔重新登录

### 如果想要后端重启也不用登录

需要启用Redis持久化，有两种方式：

#### 方式A：修改Redis服务配置（永久生效）

1. **复制配置文件**
   ```bash
   copy redis.conf "D:\Program Files\Redis\redis.windows.conf"
   ```

2. **在任务管理器重启Redis服务**
   - 右键Redis → 重新启动

3. **完成！**
   - Redis会自动加载新配置
   - 启用持久化功能
   - 重启后数据不丢失

#### 方式B：停止服务并手动启动（临时）

1. **在任务管理器停止Redis服务**
   - 右键Redis → 停止

2. **运行启动脚本**
   ```
   双击：start_redis_persistent.bat
   ```

3. **完成！**
   - 使用自定义配置运行
   - 启用持久化功能

## 推荐方案对比

| 方案 | 操作难度 | 后端重启后 | 适用场景 |
|------|----------|------------|----------|
| **当前配置** | ⭐ 最简单 | 需要重新登录 | 开发环境（推荐） |
| **方式A** | ⭐⭐ 简单 | 无需重新登录 | 生产环境 |
| **方式B** | ⭐⭐⭐ 中等 | 无需重新登录 | 临时测试 |

## 我的建议

### 对于开发环境（当前情况）

**直接使用当前配置，无需任何操作！**

**理由**：
1. ✅ Token已经延长到7天
2. ✅ 前端有友好的重新登录提示
3. ✅ 重新登录只需点击一次
4. ✅ 开发时不会频繁重启后端
5. ✅ 即使重启，重新登录也很快

**什么时候需要重新登录？**
- 后端服务重启时
- Redis服务重启时
- Token真的过期时（7天后）

**重新登录有多麻烦？**
- 系统自动弹出提示
- 点击"重新登录"按钮
- 输入用户名密码
- 完成！（不到10秒）

### 对于生产环境

**必须使用方式A（修改服务配置）**

**理由**：
1. 服务器可能重启
2. Redis可能重启
3. 用户体验要求高
4. 数据安全很重要

## 快速决策

**问自己一个问题**：

> 我能接受后端重启后重新登录一次吗？

- **能接受** → 无需任何操作，当前配置已经很好
- **不能接受** → 使用方式A修改Redis配置

## 总结

✅ **在任务管理器重启Redis服务**：
- 操作最简单
- 但数据会丢失
- 用户需要重新登录

✅ **当前配置（Token延长7天）**：
- 已经足够好用
- 7天内无需重新登录
- 前端有友好提示
- **推荐用于开发环境**

✅ **启用Redis持久化**：
- 后端重启也不用登录
- 用户体验最好
- **推荐用于生产环境**

**现在可以直接使用系统，无需任何额外操作！**
